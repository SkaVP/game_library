{% extends 'core/base.html' %}
{% block title %}–î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä—É{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4 text-center">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∏–≥—Ä—É</h2>

    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-success">{{ message }}</div>
        {% endfor %}
    {% endif %}

    {% if form.errors %}
        <div class="alert alert-danger">
            <ul class="mb-0">
                {% for field in form %}
                    {% for error in field.errors %}
                        <li><strong>{{ field.label }}:</strong> {{ error }}</li>
                    {% endfor %}
                {% endfor %}
                {% for error in form.non_field_errors %}
                    <li>{{ error }}</li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}

    <form method="post" enctype="multipart/form-data" class="mt-3">
        {% csrf_token %}

        <div class="mb-3">
            <label for="id_title" class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
            {{ form.title }}
        </div>

        <div class="mb-3">
            <label for="id_description" class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
            {{ form.description }}
        </div>

        <div class="mb-3">
            <label for="id_genre" class="form-label">–ñ–∞–Ω—Ä</label>
            {{ form.genre }}
        </div>

        <div class="mb-3">
            <label for="id_release_date" class="form-label">–î–∞—Ç–∞ —Ä–µ–ª–∏–∑–∞</label>
            {{ form.release_date }}
        </div>

        <div class="mb-3">
            <label for="id_cover" class="form-label">–û–±–ª–æ–∂–∫–∞</label>
            {{ form.cover }}
            <div id="cover-preview" class="mt-2"></div>
        </div>

        <button type="submit" class="btn btn-primary w-100">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–≥—Ä—É</button>
    </form>
</div>

<script>
document.getElementById('id_cover').addEventListener('change', function(event) {
    const previewContainer = document.getElementById('cover-preview');
    previewContainer.innerHTML = '';
    const file = event.target.files[0];
    if (file) {
        const img = document.createElement('img');
        img.src = URL.createObjectURL(file);
        img.className = 'img-fluid mt-2';
        img.style.maxHeight = '200px';
        previewContainer.appendChild(img);
    }
});
</script>
{% endblock %}