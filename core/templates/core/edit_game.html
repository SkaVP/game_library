{% extends 'core/base.html' %}
{% block title %}–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–≥—Ä—É{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–≥—Ä—É</h2>

    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-success">{{ message }}</div>
        {% endfor %}
    {% endif %}

    <form method="post" enctype="multipart/form-data" class="mt-3">
        {% csrf_token %}

        <div class="mb-3">
            <label for="id_title" class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
            {{ form.title }}
        </div>

        <div class="mb-3">
            <label for="id_description" class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
            {{ form.description }}
        </div>

        <div class="mb-3">
            <label for="id_genre" class="form-label">–ñ–∞–Ω—Ä</label>
            {{ form.genre }}
        </div>

        <div class="mb-3">
            <label for="id_release_date" class="form-label">–î–∞—Ç–∞ —Ä–µ–ª–∏–∑–∞</label>
            {{ form.release_date }}
        </div>

        <div class="mb-3">
            <label for="id_cover" class="form-label">–û–±–ª–æ–∂–∫–∞</label>
            {{ form.cover }}
            {% if game.cover %}
                <div class="mt-2">
                    <p>–¢–µ–∫—É—â–∞—è –æ–±–ª–æ–∂–∫–∞:</p>
                    <img src="{{ game.cover.url }}" alt="–û–±–ª–æ–∂–∫–∞" class="img-fluid" style="max-height: 200px;">
                    <form method="post" class="mt-2">
                        {% csrf_token %}
                        <button type="submit" name="delete_cover" class="btn btn-outline-danger btn-sm">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –æ–±–ª–æ–∂–∫—É</button>
                    </form>
                </div>
            {% endif %}
        </div>

        <button type="submit" class="btn btn-success">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
    </form>
</div>

<script>
document.getElementById('id_cover').addEventListener('change', function(event) {
    const preview = document.createElement('img');
    preview.style.maxHeight = '200px';
    preview.className = 'img-fluid mt-2';
    const file = event.target.files[0];
    if (file) {
        preview.src = URL.createObjectURL(file);
        const container = event.target.closest('.mb-3');
        container.appendChild(preview);
    }
});
</script>
{% endblock %}